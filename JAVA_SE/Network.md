### 网络编程

#### 1网络编程入门

##### 1.1 网络编程概述

计算机网络

* 指将地理位置不同的具有独立功能的多台计算机及其外部设备，通过通行线路连接起来，在网络操作系统。网络管理软件及网络通信协议的管理和协调下，实现资源共享和信息传递的计算机系统

网络编程

* 在网络通信协议下，实现网络互联的不同计算机上运行的程序间可以进行数据交换

##### 1.2 网络编程三要素

1、IP地址

* 计算机在网络中的唯一标识

2、端口号

* 计算机中的应用程序标识

3、协议

* 管理和连接网络的一系列规则，常见的有UDP和TCP协议

##### 1.3 ip地址

IP地址：计算机在网络中的唯一标识

分为两大类：

* ipv4：是每个连接网络上的主机分配的一个32bit地址。按照TCP/IP规定，IP地址用二进制表示，有32位也是4个字节。使用点分十进制表示法
* ipv6：为了满足IP地址数量的不足，扩大地址空间，通过ipv6重新定义地址空间，采用128位地址长度，每16个字节一组，分为8组十六进制数，可以有效的解决ipv4地址数量不足的问题

##### 1.4 InetAddress的使用

为了获取IP地址java提供了InetAddress类给我们使用

InetAddress：此类表示Internet协议（IP）协议

* static InetAddress getByName(String host); 	确定主机名称的IP地址，主机名可以是机器名称，也可以是IP地址。
* String getHostName();     获取此IP地址的主机名
* String getHostAddress();    返回文本显示中的IP地址字符串

##### 1.5 端口

端口：设备上应用程序的唯一标识

端口号：用两个字节表示的整数，取值范围是0~65535.其中，0~1023之间的端口号用于一些知名的网络服务和应用，普通的应用程序需要使用1024以上的端口号。如果一个端口被另一个服务或应用所占用，会导致当前应用程序启动失败。

##### 1.6 协议

协议：计算机网络中，连接和通信的规则被称为网络通信协议

UDP协议

* 中文名：用户数据报协议
* UDP是无连接通信协议，即在数据传输时，数据的发送端和接收端不建立逻辑连接。
* 应用场景：视频会议、网络语言电话、即时通讯

TCP协议

* 中文名：传输控制协议
* 面向连接的通信协议，数据传输之前眼发送端和接收端建立逻辑连接，然后传输数据，他提供两台计算机之间可靠的数据传输，每次传输前都要建立三次握手

* 三次握手：TCP协议中，在发送数据的准备阶段，客户端和服务器之间的三次交换，以保证数据的可靠性

    ​		第一次握手：客户端向服务器端发送连接请求，等待服务器确定

    ​		第二次握手：服务器端向客户端回送一个响应，通知客户端收到连接

    ​		第三次握手：客户端在次向服务器端发送确定信息，确定连接

* 应用场景：上传文件、下载文件、浏览网页

#### 2 UDP通信程序

##### 2.1 UDP通信原理

UDP协议是一种不可靠的网络协议，他在通信的两端各建立一个Socket对象，但是这两个Socket只是发送，接收数据的对象因此对于基于UDP协议的通信双方而言，没有所谓的客户端和服务器端的概念
Java提供DatagramSocket类作为基于UDP协议的Socket

##### 2.2 UDP发送数据

具体步骤：

* 创建发送端的Socket对象
    * DatagramSocket() 构造一个数据报套接字并将其绑定到本地主机上的任何可用端口。
* 创建数据，并把数据打包
    * DatagramPacket(byte[] buf, int length, InetAddress address, int port) 构造一个数据报包，用于将长度为 length的数据包发送到指定主机上的指定端口号。  
* 调用DatagramSocket对象的方法发送数据
    * void send(DatagramPacket p) 从此套接字发送数据报包。 
* 关闭发送端
    * void close();

##### 2.3 UDP接收数据

具体步骤：

* 创建接收端的Socket对象	
    * DatagramSocket(int port); 使用规定的端口号接收数据 
* 创建一个数据包，用于接收数据
    * DatagramPacket(byte[] buf, int length) 构建一个DatagramPacket 用于接收长度为Length数据包
* 调用DatagramSocket对象的方法接收数据
    * DatagramSocket void receive(DatagramPacket p) 从此套接字接收数据报包。 
* 解析数据包，并把数据在控制台输出
    * DatagramPacke byte[] getData() 返回数据缓冲区。  
* 关闭接收端
    * void close();

#### 3 TCP通信程序

##### 3.1 TCP通信原理

TCP通信协议是一种可靠的网络协议，他在两端各建立一个Socket对象，从而在通信的两端形成网络虚拟链路，一旦建立虚拟链路，两端就可以通信

java对基于TCP协议的网络提供了良好的封装，使用Socket对象来代表两端的通信端口，并通过socket产生IO流来进行网络通信

java为客户端提供Socket类，为服务器端提供ServerSocket类

##### 3.2 TCP传送数据

具体步骤：

* 创建客户端的Socket对象
    *  Socket(String host, int port) 创建流套接字并将其连接到指定主机上的指定端口号。 
* 获取输出流，写数据
    * OutputStream getOutputStream() 返回此套接字的输出流，不需要new，使用socket对象。
* 释放资源
    * void close();

注意问题：没有服务器端发送数据会出现异常。

##### 3.3 TCP接收数据

具体步骤：

* 创建服务器端的Socket对象(ServerSocket)
    * ServerSocket(int port) 创建绑定到指定端口的服务器套接字。 
* 监听客户端的连接，返回一个Socket对象
    * Socket accept() 侦听对此套接字的连接并接受它，使用服务器端的socket对象，不需要new。
* 获取输入流，读数据并把数据显示在控制台
    * InputStream 他接收的是Socket对象，而不需要new。(getInputStream方法)
* 释放资源